
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "user-guide/vision/auto_quickstarts/plot_quickstart.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_user-guide_vision_auto_quickstarts_plot_quickstart.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_user-guide_vision_auto_quickstarts_plot_quickstart.py:


.. _quick_vision:

Quickstart - Get Deepchecks Monitoring Up and Running for Computer Vision Data
******************************************************************************

This quickstart is the perfect starting point for monitoring your vision model using Deepchecks Monitoring. We'll
quickly walk you through setting up a model to represent your task in the system, uploading data, setting the
computed checks and alerts in the system and seeing some results for your effort. We'll be using the
`Mask Detection Dataset <https://www.kaggle.com/datasets/andrewmvd/face-mask-detection>`__, in which
the goal of the model is to detect faces, and classify whether the face is wearing a mask, partially wearing a mask or not wearing a mask.

.. code-block:: bash

    # Before we start, if you don't have deepchecks-client installed yet, run:
    import sys
    !{sys.executable} -m pip install -U deepchecks-client

    # or install using pip from your python environment

Creating a New Model Version
============================

Our first step is to create a new model version in the system. A model in Deepchecks Monitoring
represents an ML pipeline performing a single task in production through time,
where the model's versions and the structure of the data may change over time.
Our terminology to refer to a specific version within a model is "model version".

The easiest way to create a model version, which is demonstrated
here, requires a :doc:`Vision Data <deepchecks:user-guide/vision/data-classes>` object
containing the reference data for the version. Reference data is a dataset to which we wish to compare
our production data stream. Typically, this will be the dataset on which the model was trained.
Providing reference data is optional yet many important :doc:`checks <deepchecks:user-guide/general/deepchecks_hierarchy>`
such as :doc:`Train Test Prediction Drift (Vision Version) <deepchecks:checks_gallery/vision/model_evaluation/plot_train_test_prediction_drift>`
cannot run without it.

.. GENERATED FROM PYTHON SOURCE LINES 40-47

Preparing the Reference Data
-------------------------------

In this example we're loading a pre-made VisionData object containing the data at the first time stamp, with which
the model was trained. In order to create your own VisionData object from your own pytorch dataloader
please read the :doc:`Vision Data <deepchecks:user-guide/vision/data-classes/index>` documentation or follow the
appropriate deepchecks computer vision :doc:`quickstart <deepchecks:user-guide/vision/auto_quickstarts/index>`.

.. GENERATED FROM PYTHON SOURCE LINES 47-52

.. code-block:: default


    from deepchecks.vision.datasets.detection.mask import load_dataset, load_model, get_data_timestamps
    ref_dataset = load_dataset(day_index=0, object_type='VisionData', shuffle=False)
    model = load_model()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/416968083 [00:00<?, ?it/s]      0%|          | 17408/416968083 [00:00<40:05, 173305.84it/s]      0%|          | 52224/416968083 [00:00<25:23, 273706.92it/s]      0%|          | 121856/416968083 [00:00<15:00, 462769.62it/s]      0%|          | 261120/416968083 [00:00<08:26, 822797.61it/s]      0%|          | 557056/416968083 [00:00<04:23, 1577896.82it/s]      0%|          | 1148928/416968083 [00:00<02:17, 3024952.40it/s]      1%|          | 2323456/416968083 [00:00<01:11, 5821279.85it/s]      1%|1         | 4699136/416968083 [00:00<00:36, 11425821.41it/s]      2%|1         | 6550528/416968083 [00:00<00:30, 13560624.34it/s]      2%|2         | 8811520/416968083 [00:01<00:25, 16259517.94it/s]      3%|2         | 10859520/416968083 [00:01<00:23, 17461523.06it/s]      3%|3         | 13317120/416968083 [00:01<00:20, 19526085.35it/s]      4%|3         | 15512576/416968083 [00:01<00:19, 20174316.32it/s]      4%|4         | 17904640/416968083 [00:01<00:18, 21210632.19it/s]      5%|4         | 20100096/416968083 [00:01<00:18, 21342957.17it/s]      5%|5         | 22541312/416968083 [00:01<00:17, 22168995.28it/s]      6%|5         | 24759296/416968083 [00:01<00:17, 22039090.80it/s]      7%|6         | 27210752/416968083 [00:01<00:17, 22728567.31it/s]      7%|7         | 29485056/416968083 [00:01<00:17, 22592203.22it/s]      8%|7         | 31962112/416968083 [00:02<00:16, 23142066.77it/s]      8%|8         | 34277376/416968083 [00:02<00:16, 23005875.47it/s]      9%|8         | 36598784/416968083 [00:02<00:16, 23007210.67it/s]      9%|9         | 38899712/416968083 [00:02<00:16, 22905271.94it/s]     10%|9         | 41251840/416968083 [00:02<00:16, 22992138.15it/s]     10%|#         | 43594752/416968083 [00:02<00:16, 23031356.80it/s]     11%|#1        | 45970432/416968083 [00:02<00:16, 23154000.56it/s]     12%|#1        | 48296960/416968083 [00:02<00:15, 23087498.85it/s]     12%|#2        | 50770944/416968083 [00:02<00:15, 23476246.38it/s]     13%|#2        | 53118976/416968083 [00:02<00:15, 23287321.18it/s]     13%|#3        | 55448576/416968083 [00:03<00:15, 23166661.41it/s]     14%|#3        | 57765888/416968083 [00:03<00:15, 23119788.75it/s]     14%|#4        | 60078080/416968083 [00:03<00:15, 23007621.61it/s]     15%|#4        | 62379008/416968083 [00:03<00:15, 22918286.40it/s]     16%|#5        | 64713728/416968083 [00:03<00:15, 23018637.50it/s]     16%|#6        | 67318784/416968083 [00:03<00:14, 23817414.72it/s]     17%|#6        | 69891072/416968083 [00:03<00:14, 24278227.58it/s]     17%|#7        | 72430592/416968083 [00:03<00:14, 24511415.80it/s]     18%|#7        | 75019264/416968083 [00:03<00:13, 24810247.20it/s]     19%|#8        | 77591552/416968083 [00:03<00:13, 24959463.62it/s]     19%|#9        | 80088064/416968083 [00:04<00:13, 24786197.05it/s]     20%|#9        | 82670592/416968083 [00:04<00:13, 24840845.33it/s]     20%|##        | 85154816/416968083 [00:04<00:13, 24828116.44it/s]     21%|##1       | 87638016/416968083 [00:04<00:13, 24721212.03it/s]     22%|##1       | 90223616/416968083 [00:04<00:13, 25038537.07it/s]     22%|##2       | 93008896/416968083 [00:04<00:12, 25762194.80it/s]     23%|##2       | 95794176/416968083 [00:04<00:12, 26262394.23it/s]     24%|##3       | 98563072/416968083 [00:04<00:11, 26571706.20it/s]     24%|##4       | 101233664/416968083 [00:04<00:11, 26498383.11it/s]     25%|##4       | 104100864/416968083 [00:04<00:11, 27033922.49it/s]     26%|##5       | 106869760/416968083 [00:05<00:11, 27100464.27it/s]     26%|##6       | 109638656/416968083 [00:05<00:11, 27159419.09it/s]     27%|##6       | 112407552/416968083 [00:05<00:11, 27200901.81it/s]     28%|##7       | 115128320/416968083 [00:05<00:11, 26975425.21it/s]     28%|##8       | 117826560/416968083 [00:05<00:11, 26858577.70it/s]     29%|##8       | 120513536/416968083 [00:05<00:11, 26734578.00it/s]     30%|##9       | 123187200/416968083 [00:05<00:11, 26628931.11it/s]     30%|###       | 125908992/416968083 [00:05<00:10, 26803071.99it/s]     31%|###       | 128709632/416968083 [00:05<00:10, 27071199.25it/s]     32%|###1      | 131417088/416968083 [00:05<00:10, 26902874.51it/s]     32%|###2      | 134149120/416968083 [00:06<00:10, 26947624.66it/s]     33%|###2      | 136844288/416968083 [00:06<00:10, 26666433.05it/s]     33%|###3      | 139511808/416968083 [00:06<00:10, 26590710.86it/s]     34%|###4      | 142172160/416968083 [00:06<00:10, 26489347.91it/s]     35%|###4      | 144822272/416968083 [00:06<00:10, 26404213.82it/s]     35%|###5      | 147463168/416968083 [00:06<00:10, 26304749.97it/s]     36%|###5      | 150093824/416968083 [00:06<00:10, 26158491.85it/s]     37%|###6      | 152710144/416968083 [00:06<00:10, 26132436.86it/s]     37%|###7      | 155324416/416968083 [00:06<00:10, 25891706.78it/s]     38%|###7      | 158161920/416968083 [00:07<00:09, 26627222.17it/s]     39%|###8      | 160826368/416968083 [00:07<00:09, 26418959.26it/s]     39%|###9      | 163469312/416968083 [00:07<00:09, 26307999.11it/s]     40%|###9      | 166100992/416968083 [00:07<00:09, 26278168.14it/s]     40%|####      | 168729600/416968083 [00:07<00:09, 26224265.45it/s]     41%|####1     | 171353088/416968083 [00:07<00:09, 26151161.20it/s]     42%|####1     | 174273536/416968083 [00:07<00:09, 26963537.10it/s]     42%|####2     | 176970752/416968083 [00:07<00:08, 26827302.63it/s]     43%|####3     | 179762176/416968083 [00:07<00:08, 27050945.93it/s]     44%|####3     | 182694912/416968083 [00:07<00:08, 27608979.66it/s]     44%|####4     | 185456640/416968083 [00:08<00:08, 27251723.99it/s]     45%|####5     | 188183552/416968083 [00:08<00:08, 27210810.23it/s]     46%|####5     | 190905344/416968083 [00:08<00:08, 27118250.39it/s]     46%|####6     | 193617920/416968083 [00:08<00:08, 27013889.70it/s]     47%|####7     | 196320256/416968083 [00:08<00:08, 26960987.13it/s]     48%|####7     | 199017472/416968083 [00:08<00:08, 26781088.75it/s]     48%|####8     | 201696256/416968083 [00:08<00:08, 26747732.71it/s]     49%|####9     | 204665856/416968083 [00:08<00:07, 27537075.05it/s]     50%|####9     | 207500288/416968083 [00:08<00:07, 27648757.51it/s]     50%|#####     | 210514944/416968083 [00:08<00:07, 28243731.84it/s]     51%|#####1    | 213447680/416968083 [00:09<00:07, 28432826.55it/s]     52%|#####1    | 216478720/416968083 [00:09<00:06, 28876089.50it/s]     53%|#####2    | 219542528/416968083 [00:09<00:06, 29271464.55it/s]     53%|#####3    | 222470144/416968083 [00:09<00:06, 29141423.51it/s]     54%|#####4    | 225384448/416968083 [00:09<00:06, 29011259.86it/s]     55%|#####4    | 228373504/416968083 [00:09<00:06, 29102199.48it/s]     56%|#####5    | 231437312/416968083 [00:09<00:06, 29431398.75it/s]     56%|#####6    | 234517504/416968083 [00:09<00:06, 29713092.90it/s]     57%|#####6    | 237564928/416968083 [00:09<00:06, 29819713.29it/s]     58%|#####7    | 240628736/416968083 [00:09<00:05, 29935440.92it/s]     58%|#####8    | 243708928/416968083 [00:10<00:05, 30050996.07it/s]     59%|#####9    | 246772736/416968083 [00:10<00:05, 30086365.82it/s]     60%|#####9    | 249803776/416968083 [00:10<00:05, 30032149.82it/s]     61%|######    | 252807168/416968083 [00:10<00:05, 29885863.78it/s]     61%|######1   | 255796224/416968083 [00:10<00:05, 29731016.54it/s]     62%|######2   | 258769920/416968083 [00:10<00:05, 29501076.00it/s]     63%|######2   | 261721088/416968083 [00:10<00:05, 29422548.31it/s]     63%|######3   | 264664064/416968083 [00:10<00:05, 29269051.68it/s]     64%|######4   | 267591680/416968083 [00:10<00:05, 29195025.46it/s]     65%|######4   | 270512128/416968083 [00:10<00:05, 29055582.01it/s]     66%|######5   | 273418240/416968083 [00:11<00:04, 28981926.28it/s]     66%|######6   | 276317184/416968083 [00:11<00:04, 28915309.21it/s]     67%|######6   | 279213056/416968083 [00:11<00:04, 28852779.28it/s]     68%|######7   | 282113024/416968083 [00:11<00:04, 28781270.09it/s]     68%|######8   | 284991488/416968083 [00:11<00:04, 28590865.25it/s]     69%|######9   | 287994880/416968083 [00:11<00:04, 28926230.89it/s]     70%|######9   | 291025920/416968083 [00:11<00:04, 29225068.87it/s]     71%|#######   | 294106112/416968083 [00:11<00:04, 29568537.45it/s]     71%|#######1  | 297186304/416968083 [00:11<00:04, 29815871.80it/s]     72%|#######1  | 300168192/416968083 [00:11<00:03, 29672617.77it/s]     73%|#######2  | 303135744/416968083 [00:12<00:03, 29481720.25it/s]     73%|#######3  | 306084864/416968083 [00:12<00:03, 29402925.92it/s]     74%|#######4  | 309031936/416968083 [00:12<00:03, 29372072.28it/s]     75%|#######4  | 312144896/416968083 [00:12<00:03, 29778996.80it/s]     76%|#######5  | 315241472/416968083 [00:12<00:03, 30016546.97it/s]     76%|#######6  | 318321664/416968083 [00:12<00:03, 30137235.96it/s]     77%|#######7  | 321401856/416968083 [00:12<00:03, 30216845.48it/s]     78%|#######7  | 324432896/416968083 [00:12<00:03, 30125667.31it/s]     79%|#######8  | 327480320/416968083 [00:12<00:02, 30117634.87it/s]     79%|#######9  | 330492928/416968083 [00:12<00:02, 29979838.30it/s]     80%|#######9  | 333491200/416968083 [00:13<00:02, 29825117.39it/s]     81%|########  | 336474112/416968083 [00:13<00:02, 29745853.67it/s]     81%|########1 | 339489792/416968083 [00:13<00:02, 29785104.04it/s]     82%|########2 | 342468608/416968083 [00:13<00:02, 29555564.99it/s]     83%|########2 | 345424896/416968083 [00:13<00:02, 29358958.38it/s]     84%|########3 | 348361728/416968083 [00:13<00:02, 29277315.53it/s]     84%|########4 | 351290368/416968083 [00:13<00:02, 29213673.85it/s]     85%|########4 | 354219008/416968083 [00:13<00:02, 29183718.96it/s]     86%|########5 | 357233664/416968083 [00:13<00:02, 29365500.48it/s]     86%|########6 | 360182784/416968083 [00:13<00:01, 29290971.19it/s]     87%|########7 | 363213824/416968083 [00:14<00:01, 29470954.41it/s]     88%|########7 | 366244864/416968083 [00:14<00:01, 29591658.54it/s]     89%|########8 | 369275904/416968083 [00:14<00:01, 29681902.77it/s]     89%|########9 | 372244480/416968083 [00:14<00:01, 29552425.71it/s]     90%|########9 | 375239680/416968083 [00:14<00:01, 29560861.56it/s]     91%|######### | 378205184/416968083 [00:14<00:01, 29463865.48it/s]     91%|#########1| 381187072/416968083 [00:14<00:01, 29465138.04it/s]     92%|#########2| 384267264/416968083 [00:14<00:01, 29751777.65it/s]     93%|#########2| 387298304/416968083 [00:14<00:00, 29803303.18it/s]     94%|#########3| 390279168/416968083 [00:15<00:00, 29652744.03it/s]     94%|#########4| 393245696/416968083 [00:15<00:00, 29549665.29it/s]     95%|#########5| 396211200/416968083 [00:15<00:00, 29458555.98it/s]     96%|#########5| 399225856/416968083 [00:15<00:00, 29550809.01it/s]     96%|#########6| 402181120/416968083 [00:15<00:00, 29410795.00it/s]     97%|#########7| 405123072/416968083 [00:15<00:00, 29304212.37it/s]     98%|#########7| 408089600/416968083 [00:15<00:00, 29317008.42it/s]     99%|#########8| 411137024/416968083 [00:15<00:00, 29538448.39it/s]     99%|#########9| 414200832/416968083 [00:15<00:00, 29749178.23it/s]    416968704it [00:15, 26198093.93it/s]                               




.. GENERATED FROM PYTHON SOURCE LINES 53-57

Predictions must be given in one of the following formats:

1. A list predictions for each image in the dataset, according to the order they are loaded from the dataloader.
2. A dictionary where the values are the predictions and the keys are the image indices in the pytorch Dataset object.

.. GENERATED FROM PYTHON SOURCE LINES 58-64

.. code-block:: default


    ref_predictions = []
    for batch in ref_dataset:
        ref_predictions.extend(list(model(batch[0])))









.. GENERATED FROM PYTHON SOURCE LINES 65-75

Creating a model version
------------------------
In order to create a model version we must first create an organization in the
`deepchecks system <https://app.deepchecks.com/>`_ and generate a personal
API token using the application's dashboard.

.. image:: /_static/images/quickstart/get_api_token.png
   :width: 600

Using the API token we can now create a new model version and upload the reference data.

.. GENERATED FROM PYTHON SOURCE LINES 75-92

.. code-block:: default


    import os
    import typing as t
    import numpy as np
    import torch
    from deepchecks_client import DeepchecksClient

    host = os.environ.get('DEEPCHECKS_API_HOST')  # Replace this with https://app.deepchecks.com
    # note to put the API token in your environment variables. Or alternatively (less recommended):
    # os.environ['DEEPCHECKS_API_TOKEN'] = 'uncomment-this-line-and-insert-your-api-token-here'
    model_name = 'Mask Data'
    dc_client = DeepchecksClient(host=host, token=os.getenv('DEEPCHECKS_API_TOKEN'))
    model_version = dc_client.create_vision_model_version(model_name=model_name, version_name='v1',
                                                          reference_dataset=ref_dataset,
                                                          reference_predictions=ref_predictions,
                                                          task_type='vision_detection')





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Model Mask Data was successfully created!. Default checks, monitors and alerts added.
    Reference data uploaded.




.. GENERATED FROM PYTHON SOURCE LINES 93-103

Uploading Production Data
=========================

No matter what else you'll be doing with Deepchecks Monitoring, it will start by uploading some production data that
you want monitored. In this the mask data collected for dates ranging from the start of July 2022 to the end of
August 2022. For simplicity and quicker runtime, we'll upload only the last few days in this tutorial.
Then, we'll update the labels for some of the samples we uploaded.

Uploading Data and Predictions
------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 103-139

.. code-block:: default


    number_of_batches_to_upload = 5  # Limited to save time running this tutorial
    batch_size = 32

    # Only upload the last few days.
    daily_timestamps = get_data_timestamps()[55:]
    # To upload all production data, use:
    # daily_timestamps = get_data_timestamps()[1:]
    # (Disregard the first day, which is the reference data)


    # Defining a helper function that will convert the label format to the one supported by Deepchecks Monitoring.
    def extract_label_dict(in_dict: t.Dict[str, torch.Tensor]) -> torch.Tensor:
        return torch.concat([in_dict['labels'].reshape((-1, 1)), in_dict['boxes']], axis=1)


    for day_idx, timestamp in enumerate(daily_timestamps):
        # Load the DataLoader for the current day
        data_loader = load_dataset(day_index=day_idx, object_type='DataLoader', batch_size=batch_size)

        for batch_id, batch in enumerate(data_loader):
            # We also upload only a small number of batches in this example to save time.
            # Remove this for loop to upload all data from chosen timestamps.
            if batch_id >= number_of_batches_to_upload:
                break

            indices = [f'{timestamp}_{batch_id}_{i}' for i in range(batch_size)]
            timestamps = [timestamp] * batch_size

            model_version.log_batch(sample_id=indices,
                                    timestamps=timestamps,
                                    images=[np.array(x.permute(1, 2, 0)) * 255 for x in batch[0]],
                                    labels=[extract_label_dict(tensor) for tensor in batch[1]],
                                    predictions=model(batch[0])
                                    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.
    32 new samples were successfully logged.




.. GENERATED FROM PYTHON SOURCE LINES 140-151

Images, labels and prediction must be provided in specific required formats.
The required format for the can be found at :doc:`here <deepchecks:user-guide/vision/data-classes/index>`.
Please look at the following entries:

- Image format - can be found at :doc:`here <deepchecks:user-guide/vision/data-classes/VisionData>`.
- Label & prediction format - look at documentation of the respective VisionData subclass according to your task type

In this example, the changes needed in the data format are pretty trivial, but in more complex cases
you may either implement them in dedicated functions (such as the ``extract_label_dict`` function here), or use
the ``batch_to_image`` and other formatting methods you already implemented as part of building your
Deepchecks VisionData object.

.. GENERATED FROM PYTHON SOURCE LINES 154-158

Updating the Labels
-------------------
In many real world scenarios, the labels of the data are only available at a later time. We can update them
in hindsight using the global sample ids. Here we update the last sample that was uploaded.

.. GENERATED FROM PYTHON SOURCE LINES 158-163

.. code-block:: default


    model_version.update_sample(sample_id=indices[-1],
                                label=[extract_label_dict(tensor) for tensor in batch[1]][-1])
    model_version.send()








.. GENERATED FROM PYTHON SOURCE LINES 164-171

You can update multiple samples. Once done updating all desired samples, call the `send` method to upload the samples
and make the updates appear in the system.

When updating multiple samples we can verify that status of the process that is running in the background by checking
the amount of samples that have been processed and uploaded by the system, using:
model_version.time_window_statistics(min(prod_data[timestamp]), max(prod_data[timestamp]))
upon completion, the statistics should equal the total number of samples sent

.. GENERATED FROM PYTHON SOURCE LINES 173-185

The Dashboard Screen
====================
After creating the model version and uploading the data, we can now see the monitors within the
`application dashboard <https://app.deepchecks.com/>`_.
The monitors below are generated by default when a new model is created, all versions of the same model are tracked
within the same monitor.

.. image:: /_static/images/quickstart/vision_dashboard_w_defaults.png
   :width: 600

Note: The displayed dashboard was created using all the production data, not only the last few days


.. GENERATED FROM PYTHON SOURCE LINES 187-188

If we wish to remove the model to free up space for new models we can do it in the following way:

.. GENERATED FROM PYTHON SOURCE LINES 188-191

.. code-block:: default


    # CAUTION: This will delete the model, all model versions, and all associated datasets.
    dc_client.delete_model(model_name)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    The following model was successfully deleted: Mask Data





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  49.762 seconds)


.. _sphx_glr_download_user-guide_vision_auto_quickstarts_plot_quickstart.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_quickstart.py <plot_quickstart.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_quickstart.ipynb <plot_quickstart.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_

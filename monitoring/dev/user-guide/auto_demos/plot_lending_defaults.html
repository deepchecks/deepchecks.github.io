
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T7QZJCX');</script>
<!-- End Google Tag Manager -->
<meta name="title" content="Predicting Loan Defaults (Classification) | Deepchecks Documentation">
<meta name="description" content="Do you need to know more about Predicting Loan Defaults (Classification)? Read more at Deepchecks Online Documentation">
<meta name="docsearch:version" content="">


<!-- Warning: 
        The 'shortcut link' type is often seen before icon, but this link type is non-conforming, 
        ignored and web authors must not use it anymore. 
        MDN docs https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types
    -->
<link rel="shortcut icon" href="/_static/favicons/favicon.ico">
<!--<link rel="canonical" href="https://docs.deepchecks.com/stable/user-guide/auto_demos/plot_lending_defaults.html" />-->

<link rel="icon" href="/_static/favicons/favicon.png" sizes="32x32">
<link rel="icon" href="/_static/favicons/favicon.png" sizes="192x192">

<!-- Note: 
        Apple's iOS does not use this 'link' type, nor the 'sizes' attribute, 
        like others mobile browsers do, to select a webpage icon for Web Clip 
        or a start-up placeholder. Instead it uses the non-standard 'apple-touch-icon'.
        MDN docs: https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types;
        Safari Web Content Guide: https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html#//apple_ref/doc/uid/TP40002051-CH3-SW4
    -->
<link rel="apple-touch-icon" href="/_static/favicons/apple-touch-icon.png" sizes="32x32">
<link rel="apple-touch-icon" href="/_static/favicons/apple-touch-icon.png" sizes="192x192">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />


    <title>Predicting Loan Defaults (Classification) &#8212; Deepchecks Monitoring  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" crossorigin="anonymous"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"
    crossorigin="anonymous"></script>

    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API Reference" href="../../api/index.html" />
    <link rel="prev" title="Predicting Rent Prices (Regression)" href="plot_rent_prediction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>

<body data-spy="scroll" data-target="#bd-toc-nav">

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T7QZJCX"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    <script>
        require.config({
            paths: {
                "docsearchLib": "https://cdn.jsdelivr.net/npm/@docsearch/js@3?noext",
                "clipboardjs": "//_static/clipboard.min"
            }
        }

        );
        // require(["docsearchLib"], function (docsearch) {
        //     docsearch({
        //         appId: "3UQ0BSGJ1N", apiKey: "83d250f88e29e9906a50ddf40a1871ce", indexName: "deepchecks", container: '#algolia-search', debug: false,
        //         searchParameters: {
        //             facetFilters: ["version:"]
        //         }
        //     });
        // });
        require(["clipboardjs"], function(clipboardJS) {
            window.ClipboardJS=clipboardJS
        });
    </script>
    <script data-url_root="/" id="documentation_options" src="//_static/documentation_options.js"></script>
    <script src="//_static/copybutton.js"></script>

    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/deepchecks_logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../getting-started/index.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../installation/index.html">
  Installation
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api/index.html">
  API Reference
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://staging-v2.deepchecks.com/docs">API Docs<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/deepchecks/deepchecks" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://deepchecks.com/slack" rel="noopener" target="_blank" title="Slack"><span><i class="fab fa-slack"></i></span>
            <label class="sr-only">Slack</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://pypi.org/project/deepchecks/" rel="noopener" target="_blank" title="PyPI"><span><i class="fab fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  General
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../general/workspace_and_users.html">
   Workspace &amp; Users
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../general/concepts.html">
   Concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../general/faq.html">
   FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../general/aggregation_methods.html">
   Aggregation Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../general/scorers.html">
   Scorers for Metric Evaluation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tabular
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tabular/auto_quickstarts/index.html">
   Tabular Quickstarts
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular/auto_quickstarts/plot_prepare_your_data.html">
     Preparing Your Tabular Data for Deepchecks Monitoring
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tabular/auto_quickstarts/plot_quickstart.html">
     Quickstart - Get Deepchecks Monitoring Up and Running
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tabular/tabular_setup.html">
   Setting Up a New Tabular Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tabular/tabular_production.html">
   Sending Tabular Production Data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  User Interface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../user_interface/dashboard.html">
   Dashboard
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../user_interface/alerts.html">
   Alerts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../user_interface/analysis.html">
   Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../user_interface/configuration.html">
   Configuration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Examples
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Demos
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="plot_rent_prediction.html">
     Predicting Rent Prices (Regression)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Predicting Loan Defaults (Classification)
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-you-up-on-deepchecks">
   Setting You Up on Deepchecks
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installation-api-key">
     Installation &amp; API key
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-a-client">
     Creating a Client
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-model-model-version">
   Creating a Model &amp; Model Version
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-the-data">
     Getting the Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-schema">
     Data Schema
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#feature-importance">
     Feature Importance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-a-model-version">
     Creating a Model Version
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uploading-production-data">
   Uploading Production Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uploading-a-batch-of-data">
     Uploading a Batch of Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uploading-the-labels">
     Uploading The Labels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#making-sure-your-data-has-arrived">
     Making Sure Your Data Has Arrived
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyzing-using-deepchecks">
   Analyzing Using Deepchecks
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dashboard-alerts-finding-drift">
     Dashboard &amp; Alerts - Finding Drift
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-detecting-integrity-issues">
     Analysis - Detecting Integrity Issues
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating-labels">
   Updating Labels
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-up">
   Cleaning up
  </a>
 </li>
</ul>

</nav>
              </div>
              
            
          </div>
          

          
    
        
    
    <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
        
            <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-user-guide-auto-demos-plot-lending-defaults-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="predicting-loan-defaults-classification">
<span id="lending-defaults"></span><span id="sphx-glr-user-guide-auto-demos-plot-lending-defaults-py"></span><h1>Predicting Loan Defaults (Classification)<a class="headerlink" href="#predicting-loan-defaults-classification" title="Permalink to this headline">#</a></h1>
<p>In this Demo we are using an adaptation of the <a class="reference external" href="https://www.kaggle.com/datasets/wordsforthewise/lending-club">Lending Club loan data</a> dataset to show how you can use Deepchecks to
monitor and identify issues in a Loan Default prediction task.</p>
<p>You are a Data Scientist in a renowned bank, and you are tasked with identifying customers that are
likely to default on their mortgage loan. In this example we’ll use Deepchecks to quickly detect some data integrity
issues that occur over the lifetime of the model, and we’ll see how Deepchecks can alert us about potential model
deterioration that can be caused by increasing interest rates, even while labels are not yet available.</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#setting-you-up-on-deepchecks">Setting You Up on Deepchecks</a></p></li>
<li><p><a class="reference internal" href="#creating-a-model-model-version">Creating a Model &amp; Model Version</a></p></li>
<li><p><a class="reference internal" href="#uploading-production-data">Uploading Production Data</a></p></li>
<li><p><a class="reference internal" href="#analyzing-using-deepchecks">Analyzing Using Deepchecks</a></p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To see how Deepchecks Monitoring is used, you can skip right to <a class="reference internal" href="#analyzing-using-deepchecks">Analyzing Using Deepchecks</a></p>
</div>
<section id="setting-you-up-on-deepchecks">
<h2>Setting You Up on Deepchecks<a class="headerlink" href="#setting-you-up-on-deepchecks" title="Permalink to this headline">#</a></h2>
<section id="installation-api-key">
<h3>Installation &amp; API key<a class="headerlink" href="#installation-api-key" title="Permalink to this headline">#</a></h3>
<p>In order to work with Deepchecks Monitoring, you need to:</p>
<ol class="arabic simple">
<li><p>Install with <code class="docutils literal notranslate"><span class="pre">pip</span></code> the deepchecks-client SDK</p></li>
<li><p>Log in to the Deepchecks Monitoring app and create an organization</p></li>
<li><p>Obtain an API key from the app</p></li>
</ol>
<p>For more details, please refer to the <a class="reference internal" href="../tabular/auto_quickstarts/plot_quickstart.html"><span class="doc">Quickstart</span></a>.</p>
</section>
<section id="creating-a-client">
<h3>Creating a Client<a class="headerlink" href="#creating-a-client" title="Permalink to this headline">#</a></h3>
<p>To work with Deepchecks Monitoring we first instantiate a client object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">deepchecks_client</span> <span class="kn">import</span> <span class="n">DeepchecksClient</span>
<span class="c1"># Note:  add an environment variable DEEPCHECKS_API_TOKEN and set it to your API token&#39;s value. Alternatively (not</span>
<span class="c1"># recommended for security reasons) copy-paste your token string here, instead of retrieving it from the environment</span>
<span class="c1"># variable.</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;DEEPCHECKS_API_TOKEN&#39;</span><span class="p">)</span>
<span class="c1"># Point the host to deepchecks host url (e.g. https://app.deepchecks.com. Save it to an environment variable,</span>
<span class="c1"># or alternatively copy-paste it here directly)</span>
<span class="n">host</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;DEEPCHECKS_API_HOST&#39;</span><span class="p">)</span>
<span class="c1"># Create a DeepchecksClient with relevant credentials</span>
<span class="n">dc_client</span> <span class="o">=</span> <span class="n">DeepchecksClient</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">token</span><span class="p">)</span>
</pre></div>
</div>
<p>We’ll use this object during the remainder of this example.</p>
</section>
</section>
<section id="creating-a-model-model-version">
<h2>Creating a Model &amp; Model Version<a class="headerlink" href="#creating-a-model-model-version" title="Permalink to this headline">#</a></h2>
<p>In this section we’ll create a model and a model version, using the training data as the reference. Reference data is
a dataset to which we wish to compare our production data stream. To learn more about models and model versions, and
other important terms in Deepchecks please refer to the <a class="reference internal" href="../general/concepts.html"><span class="doc">Concepts guide</span></a>.</p>
<section id="getting-the-data">
<h3>Getting the Data<a class="headerlink" href="#getting-the-data" title="Permalink to this headline">#</a></h3>
<p>We’ll start by downloading the training data and model we’ll be using for this example. In our example we already
saved the training data for this use case in a csv file on figshare.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://figshare.com/ndownloader/files/39316160&#39;</span><span class="p">)</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>issue_d</th>
      <th>sub_grade</th>
      <th>term</th>
      <th>home_ownership</th>
      <th>fico_range_low</th>
      <th>total_acc</th>
      <th>pub_rec</th>
      <th>revol_util</th>
      <th>annual_inc</th>
      <th>int_rate</th>
      <th>dti</th>
      <th>purpose</th>
      <th>mort_acc</th>
      <th>loan_amnt</th>
      <th>application_type</th>
      <th>installment</th>
      <th>verification_status</th>
      <th>pub_rec_bankruptcies</th>
      <th>addr_state</th>
      <th>initial_list_status</th>
      <th>fico_range_high</th>
      <th>revol_bal</th>
      <th>id</th>
      <th>open_acc</th>
      <th>emp_length</th>
      <th>loan_status</th>
      <th>time_to_earliest_cr_line</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014-01-01</td>
      <td>D1</td>
      <td>60 months</td>
      <td>MORTGAGE</td>
      <td>660.0</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>86.8</td>
      <td>40440.0</td>
      <td>16.99</td>
      <td>15.16</td>
      <td>credit_card</td>
      <td>1.0</td>
      <td>17775.0</td>
      <td>Individual</td>
      <td>441.66</td>
      <td>Verified</td>
      <td>0.0</td>
      <td>AR</td>
      <td>f</td>
      <td>664.0</td>
      <td>17264.0</td>
      <td>11024793</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>1</td>
      <td>478656.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014-01-01</td>
      <td>C4</td>
      <td>60 months</td>
      <td>MORTGAGE</td>
      <td>740.0</td>
      <td>26.0</td>
      <td>0.0</td>
      <td>103.5</td>
      <td>59000.0</td>
      <td>15.61</td>
      <td>16.74</td>
      <td>credit_card</td>
      <td>4.0</td>
      <td>29175.0</td>
      <td>Individual</td>
      <td>703.45</td>
      <td>Verified</td>
      <td>0.0</td>
      <td>VT</td>
      <td>f</td>
      <td>744.0</td>
      <td>6725.0</td>
      <td>10596078</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>541728.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>So what do we have? Let’s note the special columns in our data:</p>
<ol class="arabic simple">
<li><p>issue_d - The timestamp of the sample</p></li>
<li><p>id - the id of the loan application</p></li>
<li><p>loan_status - Our label, which is the final status of the loan. 0 means “payed in full”, and 1 are defaults.</p></li>
</ol>
<p>All the other columns are features that can be used by our model to predict whether the user will default or not.</p>
</section>
<section id="data-schema">
<h3>Data Schema<a class="headerlink" href="#data-schema" title="Permalink to this headline">#</a></h3>
<p>A Schema file contains the description of the data (features and additional data) associated with a model version.
To learn more about creating a schema, please refer to the
<a class="reference internal" href="../tabular/tabular_setup.html"><span class="doc">Tabular Setup guide</span></a>.</p>
<p><strong>It is highly recommended to review the created schema file before moving forward to creating the model version.</strong></p>
<p>In order to create a schema file, the easiest way is to first define a deepchecks
<span class="xref std std-doc">Dataset</span> object, which contains the actual data (DataFrame)
together with metadata about the role of each column.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">deepchecks.tabular</span> <span class="kn">import</span> <a href="https://docs.deepchecks.com/stable/api/deepchecks.tabular.html#deepchecks.tabular.Dataset" title="deepchecks.tabular.dataset.Dataset" class="sphx-glr-backref-module-deepchecks-tabular-dataset sphx-glr-backref-type-py-class"><span class="n">Dataset</span></a>
<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sub_grade&#39;</span><span class="p">,</span> <span class="s1">&#39;term&#39;</span><span class="p">,</span> <span class="s1">&#39;home_ownership&#39;</span><span class="p">,</span> <span class="s1">&#39;fico_range_low&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;pub_rec&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_util&#39;</span><span class="p">,</span> <span class="s1">&#39;annual_inc&#39;</span><span class="p">,</span> <span class="s1">&#39;int_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;dti&#39;</span><span class="p">,</span>
            <span class="s1">&#39;purpose&#39;</span><span class="p">,</span> <span class="s1">&#39;mort_acc&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_amnt&#39;</span><span class="p">,</span> <span class="s1">&#39;application_type&#39;</span><span class="p">,</span> <span class="s1">&#39;installment&#39;</span><span class="p">,</span>
            <span class="s1">&#39;verification_status&#39;</span><span class="p">,</span> <span class="s1">&#39;pub_rec_bankruptcies&#39;</span><span class="p">,</span> <span class="s1">&#39;addr_state&#39;</span><span class="p">,</span>
            <span class="s1">&#39;initial_list_status&#39;</span><span class="p">,</span> <span class="s1">&#39;fico_range_high&#39;</span><span class="p">,</span> <span class="s1">&#39;revol_bal&#39;</span><span class="p">,</span> <span class="s1">&#39;open_acc&#39;</span><span class="p">,</span>
            <span class="s1">&#39;emp_length&#39;</span><span class="p">,</span> <span class="s1">&#39;time_to_earliest_cr_line&#39;</span><span class="p">]</span>
<span class="n">cat_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sub_grade&#39;</span><span class="p">,</span> <span class="s1">&#39;home_ownership&#39;</span><span class="p">,</span> <span class="s1">&#39;term&#39;</span><span class="p">,</span> <span class="s1">&#39;purpose&#39;</span><span class="p">,</span> <span class="s1">&#39;application_type&#39;</span><span class="p">,</span> <span class="s1">&#39;verification_status&#39;</span><span class="p">,</span> <span class="s1">&#39;addr_state&#39;</span><span class="p">,</span>
                <span class="s1">&#39;initial_list_status&#39;</span><span class="p">]</span>

<span class="n">dataset_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="n">features</span><span class="p">,</span>
    <span class="s1">&#39;cat_features&#39;</span><span class="p">:</span> <span class="n">cat_features</span><span class="p">,</span>
    <span class="s1">&#39;index_name&#39;</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">,</span>
    <span class="s1">&#39;datetime_name&#39;</span><span class="p">:</span> <span class="s1">&#39;issue_d&#39;</span>
<span class="p">}</span>
<a href="https://docs.deepchecks.com/stable/api/deepchecks.tabular.html#deepchecks.tabular.Dataset" title="deepchecks.tabular.dataset.Dataset" class="sphx-glr-backref-module-deepchecks-tabular-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_dataset</span></a> <span class="o">=</span> <a href="https://docs.deepchecks.com/stable/api/deepchecks.tabular.html#deepchecks.tabular.Dataset" title="deepchecks.tabular.dataset.Dataset" class="sphx-glr-backref-module-deepchecks-tabular-dataset sphx-glr-backref-type-py-class"><span class="n">Dataset</span></a><span class="p">(</span><span class="n">train_df</span><span class="p">,</span> <span class="o">**</span><span class="n">dataset_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>We’ll create the schema file, and print it to show (and validate) the schema that was created.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">deepchecks_client</span> <span class="kn">import</span> <span class="n">create_schema</span><span class="p">,</span> <span class="n">read_schema</span>

<span class="n">schema_file_path</span> <span class="o">=</span> <span class="s1">&#39;schema_file.yaml&#39;</span>
<span class="n">create_schema</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><a href="https://docs.deepchecks.com/stable/api/deepchecks.tabular.html#deepchecks.tabular.Dataset" title="deepchecks.tabular.dataset.Dataset" class="sphx-glr-backref-module-deepchecks-tabular-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_dataset</span></a><span class="p">,</span> <span class="n">schema_output_file</span><span class="o">=</span><span class="n">schema_file_path</span><span class="p">)</span>
<span class="n">read_schema</span><span class="p">(</span><span class="n">schema_file_path</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Schema was successfully generated and saved to schema_file.yaml.

{&#39;additional_data&#39;: {}, &#39;features&#39;: {&#39;addr_state&#39;: &#39;categorical&#39;, &#39;annual_inc&#39;: &#39;numeric&#39;, &#39;application_type&#39;: &#39;categorical&#39;, &#39;dti&#39;: &#39;numeric&#39;, &#39;emp_length&#39;: &#39;numeric&#39;, &#39;fico_range_high&#39;: &#39;numeric&#39;, &#39;fico_range_low&#39;: &#39;numeric&#39;, &#39;home_ownership&#39;: &#39;categorical&#39;, &#39;initial_list_status&#39;: &#39;categorical&#39;, &#39;installment&#39;: &#39;numeric&#39;, &#39;int_rate&#39;: &#39;numeric&#39;, &#39;loan_amnt&#39;: &#39;numeric&#39;, &#39;mort_acc&#39;: &#39;numeric&#39;, &#39;open_acc&#39;: &#39;numeric&#39;, &#39;pub_rec&#39;: &#39;numeric&#39;, &#39;pub_rec_bankruptcies&#39;: &#39;numeric&#39;, &#39;purpose&#39;: &#39;categorical&#39;, &#39;revol_bal&#39;: &#39;numeric&#39;, &#39;revol_util&#39;: &#39;numeric&#39;, &#39;sub_grade&#39;: &#39;categorical&#39;, &#39;term&#39;: &#39;categorical&#39;, &#39;time_to_earliest_cr_line&#39;: &#39;numeric&#39;, &#39;total_acc&#39;: &#39;numeric&#39;, &#39;verification_status&#39;: &#39;categorical&#39;}}
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For conveniently changing the auto-inferred schema it’s recommended to edit the textual file with an app of your
choice.</p>
<p>After editing, you can use the <a class="reference internal" href="../../api/generated/deepchecks_client.tabular.utils.read_schema.html#deepchecks_client.tabular.utils.read_schema" title="deepchecks_client.tabular.utils.read_schema"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_schema</span></code></a>
function to verify the validity of the syntax in your updated schema.</p>
</div>
</section>
<section id="feature-importance">
<h3>Feature Importance<a class="headerlink" href="#feature-importance" title="Permalink to this headline">#</a></h3>
<p>In order to provide the best analysis and alerts, we should let Deepchecks know about the relative importance of the
features to the model’s prediction. In this example we’ll load our model and get its feature importance, but these can
be easily <span class="xref std std-doc">calculated using deepchecks</span>, or other methods
(such as SHAP). Note that the feature importance values should be normalized to sum to 1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="k">with</span> <span class="n">urlopen</span><span class="p">(</span><span class="s1">&#39;https://figshare.com/ndownloader/files/39316172&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">feature_importance</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">feature_names_</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="creating-a-model-version">
<h3>Creating a Model Version<a class="headerlink" href="#creating-a-model-version" title="Permalink to this headline">#</a></h3>
<p>We’ll use the <a class="reference internal" href="../../api/generated/deepchecks_client.DeepchecksClient.create_tabular_model_version.html#deepchecks_client.DeepchecksClient.create_tabular_model_version" title="deepchecks_client.DeepchecksClient.create_tabular_model_version"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_tabular_model_version</span></code></a> method. Calling it, we can create both our
model, our model version and define the reference data with one call. We’ll also let Deepchecks know this is a
binary classification task, so we will set the <code class="docutils literal notranslate"><span class="pre">task_type</span></code> argument. We’ll also set the default monitoring
frequency to be a month, to match our data which is collected on a monthly basis. Lastly, in order to fully define
the reference, we must also pass model predictions for the reference data. For classification tasks, it’s highly
recommended to also pass predicted probabilities, in order to be able to calculate metrics such as ROC AUC that are
calculated on these probabilities.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ref_predictions</span></a> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ref_predictions_proba</span></a> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>

<span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;Loan Defaults - Example&#39;</span>
</pre></div>
</div>
<p>It is also recommended to explicitly tell deepchecks about the classes in your task using the
<code class="docutils literal notranslate"><span class="pre">model_classes</span></code> argument. These names must match the labels you are sending (and the ones the model is predicting),
and must be sorted alphanumerically.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_version</span> <span class="o">=</span> <span class="n">dc_client</span><span class="o">.</span><span class="n">create_tabular_model_version</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> <span class="n">version_name</span><span class="o">=</span><span class="s1">&#39;ver_1&#39;</span><span class="p">,</span>
                                                       <span class="n">schema</span><span class="o">=</span><span class="n">schema_file_path</span><span class="p">,</span>
                                                       <span class="n">feature_importance</span><span class="o">=</span><span class="n">feature_importance</span><span class="p">,</span>
                                                       <span class="n">reference_dataset</span><span class="o">=</span><a href="https://docs.deepchecks.com/stable/api/deepchecks.tabular.html#deepchecks.tabular.Dataset" title="deepchecks.tabular.dataset.Dataset" class="sphx-glr-backref-module-deepchecks-tabular-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">train_dataset</span></a><span class="p">,</span>
                                                       <span class="n">reference_predictions</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ref_predictions</span></a><span class="p">,</span>
                                                       <span class="n">reference_probas</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ref_predictions_proba</span></a><span class="p">,</span>
                                                       <span class="n">task_type</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span>
                                                       <span class="n">model_classes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                                       <span class="n">monitoring_frequency</span><span class="o">=</span><span class="s1">&#39;month&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Model Loan Defaults - Example was successfully created!. Default checks, monitors and alerts added.
Model version ver_1 was successfully created.
/home/runner/work/monitoring/monitoring/.venv/lib/python3.9/site-packages/deepchecks_client/tabular/client.py:407: UserWarning:

Maximum size allowed for reference data is 100,000, applying random sampling

Reference data uploaded.
</pre></div>
</div>
<p>Now we know our model, model version and reference data where set, and we’re ready to start uploading production data.</p>
</section>
</section>
<section id="uploading-production-data">
<h2>Uploading Production Data<a class="headerlink" href="#uploading-production-data" title="Permalink to this headline">#</a></h2>
<p>Once in production, uploading data can be done either sample by sample, or by batch. To read more, please refer to
the <span class="xref std std-doc">Production Data Guide</span>. Here we’ll show how to use the batch upload
method. In our example we already saved the production data for all time stamps in a csv file on figshare.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prod_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://figshare.com/ndownloader/files/39316157&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;issue_d&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>We’ll change the original timestamps so the samples are recent</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">time_delta</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="datetime.timedelta" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class"><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span></a><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><a href="https://docs.python.org/3/library/datetime.html#datetime.datetime.now" title="datetime.datetime.now" class="sphx-glr-backref-module-datetime-datetime sphx-glr-backref-type-py-method"><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span></a><span class="p">())</span> <span class="o">-</span> <span class="n">prod_data</span><span class="p">[</span><span class="s1">&#39;issue_d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">-</span> <a href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="datetime.timedelta" class="sphx-glr-backref-module-datetime sphx-glr-backref-type-py-class"><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">prod_data</span><span class="p">[</span><span class="s1">&#39;issue_d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prod_data</span><span class="p">[</span><span class="s1">&#39;issue_d&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">time_delta</span>
<span class="n">prod_data</span><span class="p">[</span><span class="s1">&#39;issue_d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;DatetimeArray&gt;
[&#39;2020-12-27 08:21:31.173090&#39;, &#39;2021-01-27 08:21:31.173090&#39;,
 &#39;2021-02-27 08:21:31.173090&#39;, &#39;2021-03-29 08:21:31.173090&#39;,
 &#39;2021-04-29 08:21:31.173090&#39;, &#39;2021-05-29 08:21:31.173090&#39;,
 &#39;2021-06-29 08:21:31.173090&#39;, &#39;2021-07-30 08:21:31.173090&#39;,
 &#39;2021-08-27 08:21:31.173090&#39;, &#39;2021-09-27 08:21:31.173090&#39;,
 &#39;2021-10-27 08:21:31.173090&#39;, &#39;2021-11-27 08:21:31.173090&#39;,
 &#39;2021-12-27 08:21:31.173090&#39;, &#39;2022-01-27 08:21:31.173090&#39;,
 &#39;2022-02-27 08:21:31.173090&#39;, &#39;2022-03-29 08:21:31.173090&#39;,
 &#39;2022-04-29 08:21:31.173090&#39;, &#39;2022-05-29 08:21:31.173090&#39;,
 &#39;2022-06-29 08:21:31.173090&#39;, &#39;2022-07-30 08:21:31.173090&#39;,
 &#39;2022-08-27 08:21:31.173090&#39;, &#39;2022-09-27 08:21:31.173090&#39;,
 &#39;2022-10-27 08:21:31.173090&#39;, &#39;2022-11-27 08:21:31.173090&#39;,
 &#39;2022-12-27 08:21:31.173090&#39;, &#39;2023-01-27 08:21:31.173090&#39;,
 &#39;2023-02-27 08:21:31.173090&#39;, &#39;2023-03-29 08:21:31.173090&#39;,
 &#39;2023-04-29 08:21:31.173090&#39;, &#39;2023-05-29 08:21:31.173090&#39;]
Length: 30, dtype: datetime64[ns]
</pre></div>
</div>
<section id="uploading-a-batch-of-data">
<h3>Uploading a Batch of Data<a class="headerlink" href="#uploading-a-batch-of-data" title="Permalink to this headline">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">prod_predictions</span></a> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">prod_data</span><span class="p">[</span><a href="https://docs.deepchecks.com/stable/api/deepchecks.tabular.html#deepchecks.tabular.Dataset.features" title="deepchecks.tabular.Dataset.features" class="sphx-glr-backref-module-deepchecks-tabular sphx-glr-backref-type-py-property"><span class="n">train_dataset</span><span class="o">.</span><span class="n">features</span></a><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;NONE&#39;</span><span class="p">))</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">prod_prediction_probas</span></a> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">prod_data</span><span class="p">[</span><a href="https://docs.deepchecks.com/stable/api/deepchecks.tabular.html#deepchecks.tabular.Dataset.features" title="deepchecks.tabular.Dataset.features" class="sphx-glr-backref-module-deepchecks-tabular sphx-glr-backref-type-py-property"><span class="n">train_dataset</span><span class="o">.</span><span class="n">features</span></a><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;NONE&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We’ll also convert out pandas datetime column to int timestamps (seconds since epoch), which is the time format
expected by deepchecks.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_version</span><span class="o">.</span><span class="n">log_batch</span><span class="p">(</span><span class="n">sample_ids</span><span class="o">=</span><span class="n">prod_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">prod_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;issue_d&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;loan_status&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                        <span class="n">timestamps</span><span class="o">=</span><span class="p">(</span><span class="n">prod_data</span><span class="p">[</span><span class="s1">&#39;issue_d&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">//</span> <span class="mf">1e9</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
                        <span class="n">predictions</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">prod_predictions</span></a><span class="p">,</span>
                        <span class="n">prediction_probas</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">prod_prediction_probas</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>10000 new samples sent.
10000 new samples sent.
10000 new samples sent.
10000 new samples sent.
10000 new samples sent.
10000 new samples sent.
10000 new samples sent.
10000 new samples sent.
10000 new samples sent.
5019 new samples sent.
Upload finished successfully but might take time to ingest into the system, see http://127.0.0.1:8000/configuration/models for status.
</pre></div>
</div>
</section>
<section id="uploading-the-labels">
<h3>Uploading The Labels<a class="headerlink" href="#uploading-the-labels" title="Permalink to this headline">#</a></h3>
<p>The labels are global to the model, and not specific to a version. Therefore, to upload them we need the model client.
You can do this directly after uploading the predictions, or at any other time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_client</span> <span class="o">=</span> <span class="n">dc_client</span><span class="o">.</span><span class="n">get_or_create_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="n">model_client</span><span class="o">.</span><span class="n">log_batch_labels</span><span class="p">(</span><span class="n">sample_ids</span><span class="o">=</span><span class="n">prod_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">prod_data</span><span class="p">[</span><span class="s1">&#39;loan_status&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>10000 labels sent.
10000 labels sent.
10000 labels sent.
10000 labels sent.
10000 labels sent.
10000 labels sent.
10000 labels sent.
10000 labels sent.
10000 labels sent.
5019 labels sent.
</pre></div>
</div>
</section>
<section id="making-sure-your-data-has-arrived">
<h3>Making Sure Your Data Has Arrived<a class="headerlink" href="#making-sure-your-data-has-arrived" title="Permalink to this headline">#</a></h3>
<p>If you’re not sure if your data has arrived, please refer to the relevant section in the
<a class="reference internal" href="../tabular/tabular_production.html#tabular-production-validating-your-data-has-arrived"><span class="std std-ref">Production Data guide</span></a>.</p>
</section>
</section>
<section id="analyzing-using-deepchecks">
<h2>Analyzing Using Deepchecks<a class="headerlink" href="#analyzing-using-deepchecks" title="Permalink to this headline">#</a></h2>
<p>Now that you have our data in Deepchecks, you can start analyzing it. Has the model been performing well? The
economy has been entering a mild recession recently and you managers have raised concerns that this may have
affected your model’s ability to correctly predict loan defaults. You set to investigate.</p>
<section id="dashboard-alerts-finding-drift">
<h3>Dashboard &amp; Alerts - Finding Drift<a class="headerlink" href="#dashboard-alerts-finding-drift" title="Permalink to this headline">#</a></h3>
<p>When you log in to Deepchecks, you’ll be greeted by the Dashboard, in which you can view all the monitors defined for
your models. Selecting our <code class="docutils literal notranslate"><span class="pre">Loan</span> <span class="pre">Default</span> <span class="pre">-</span> <span class="pre">Example</span></code> model, we see the default monitors and their corresponding
default alert rules. We can also see that the Aggregate Feature Drift monitor has exceeded the default alert rule
threshold, and has triggered an alert. We can click on the alert to see more details.</p>
<img alt="Dashboard" class="align-center" src="../../_images/dashboard.gif" />
<p>Once in the alert screen, you can see the list of all current alerts on your model. Clicking on that alert will
open an alert analysis screen. This screen has three main components - the monitor history graph, the segment explorer
and the check details.</p>
<ol class="arabic simple">
<li><p>The monitor history graph shows the monitor’s value over time and the point at which the alert was triggered.</p></li>
<li><p>The segment explorer allows you to see what was the value of the check at the time of the alert, in different
segments of the data.</p></li>
<li><p>The check details section shows the details of the check that triggered the alert.</p></li>
</ol>
<p>In this case, you can see in the check details section that there is significant drift in the <code class="docutils literal notranslate"><span class="pre">int_rate</span></code> feature,
whose average has increased dramatically. This is the case for the “All Data” segment, but does this issue originate
from a specific segment? Let’s find out.</p>
<img alt="Alert" class="align-center" src="../../_images/alert.gif" />
<p>Segmenting on the <code class="docutils literal notranslate"><span class="pre">term</span></code> feature, we can easily see that the drift is coming mostly from long term loans. This is
not surprising, as the economy has been entering a mild recession recently, and long term loans are more sensitive to
increases in interest rates.</p>
</section>
<section id="analysis-detecting-integrity-issues">
<h3>Analysis - Detecting Integrity Issues<a class="headerlink" href="#analysis-detecting-integrity-issues" title="Permalink to this headline">#</a></h3>
<p>Once you got this major drift issue under control, you may be interested in looking for other issues in your data.
For freely exploring the status, you can head to the Analysis screen. There you can run any of the checks
you defined for your model over different time periods and segments and easily change the parameters of the checks.</p>
<p>Scrolling down the list of checks, you’ll find that the <code class="docutils literal notranslate"><span class="pre">Percent</span> <span class="pre">of</span> <span class="pre">Nulls</span></code> check had some non-zero values in the
past few months.</p>
<img alt="Analysis" class="align-center" src="../../_images/analysis.gif" />
<p>Clicking the check at one of the times it had been non-zero, we can see that we have some nulls in the
<code class="docutils literal notranslate"><span class="pre">home_ownership</span></code> feature. Furthermore, using the “Check Per Segment” part of the screen we can see the value of the
check when the data is segmented by various features. In this case, we can see that the nulls are happening
exclusively in loans made in California. Time to talk to the Data Engineering team! Seems like there has been some
issue with the data pipeline coming from the state of California.</p>
</section>
</section>
<section id="updating-labels">
<h2>Updating Labels<a class="headerlink" href="#updating-labels" title="Permalink to this headline">#</a></h2>
<p>In many use-cases, such as with Loan status, the labels may arrive way after the model prediction was made. In
these cases it is possible to update the labels of samples that where previously unlabeled. Let’s say for example
that we have just learned of a few loans that where paid in full, then we can update their labels using the
following function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">labels_to_update</span> <span class="o">=</span> <span class="p">[</span><span class="mi">87609</span><span class="p">,</span> <span class="mi">87640</span><span class="p">,</span> <span class="mi">87751</span><span class="p">,</span> <span class="mi">93415</span><span class="p">,</span> <span class="mi">87574</span><span class="p">,</span> <span class="mi">87446</span><span class="p">,</span> <span class="mi">87703</span><span class="p">,</span> <span class="mi">87627</span><span class="p">,</span> <span class="mi">93162</span><span class="p">,</span>
                    <span class="mi">87405</span><span class="p">,</span> <span class="mi">87549</span><span class="p">,</span> <span class="mi">87681</span><span class="p">,</span> <span class="mi">93893</span><span class="p">,</span> <span class="mi">87392</span><span class="p">,</span> <span class="mi">87390</span><span class="p">,</span> <span class="mi">87536</span><span class="p">,</span> <span class="mi">93116</span><span class="p">,</span> <span class="mi">87540</span><span class="p">,</span>
                    <span class="mi">87669</span><span class="p">,</span> <span class="mi">87608</span><span class="p">,</span> <span class="mi">87743</span><span class="p">,</span> <span class="mi">87650</span><span class="p">,</span> <span class="mi">87587</span><span class="p">,</span> <span class="mi">87545</span><span class="p">,</span> <span class="mi">87657</span><span class="p">,</span> <span class="mi">87702</span><span class="p">,</span> <span class="mi">87398</span><span class="p">,</span>
                    <span class="mi">87673</span><span class="p">,</span> <span class="mi">87408</span><span class="p">,</span> <span class="mi">87685</span><span class="p">,</span> <span class="mi">92032</span><span class="p">,</span> <span class="mi">88162</span><span class="p">,</span> <span class="mi">87515</span><span class="p">,</span> <span class="mi">87723</span><span class="p">,</span> <span class="mi">87537</span><span class="p">,</span> <span class="mi">87710</span><span class="p">,</span>
                    <span class="mi">87761</span><span class="p">,</span> <span class="mi">87445</span><span class="p">,</span> <span class="mi">87554</span><span class="p">,</span> <span class="mi">87463</span><span class="p">,</span> <span class="mi">87521</span><span class="p">,</span> <span class="mi">87659</span><span class="p">,</span> <span class="mi">87569</span><span class="p">]</span>
<span class="n">model_client</span><span class="o">.</span><span class="n">log_batch_labels</span><span class="p">(</span><span class="n">sample_ids</span><span class="o">=</span><span class="n">labels_to_update</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_to_update</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>43 labels sent.
</pre></div>
</div>
</section>
<section id="cleaning-up">
<h2>Cleaning up<a class="headerlink" href="#cleaning-up" title="Permalink to this headline">#</a></h2>
<p>If you wish to delete this model from your environment, you can do that using the <code class="docutils literal notranslate"><span class="pre">delete_model</span></code> function.
CAUTION: This will delete the model, all model versions, and all associated datasets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># dc_client.delete_model(model_name)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 4 minutes  17.658 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-user-guide-auto-demos-plot-lending-defaults-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/fe399c9845584c36973731b9381a02fa/plot_lending_defaults.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_lending_defaults.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8a99e2ac696d4a427264694f1e5618f7/plot_lending_defaults.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_lending_defaults.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


            </div>
        
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="plot_rent_prediction.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Predicting Rent Prices (Regression)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../api/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API Reference</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
    </main>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Deepchecks.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>